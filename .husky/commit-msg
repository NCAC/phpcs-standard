#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Commit message validation script
# Message must start with feat:, chore:, fix:, refacto:, docs:, or release:

commit_regex='^(feat|chore|fix|refacto|docs|release)(\(.+\))?: .{1,}'

if ! grep -qE "$commit_regex" "$1"; then
    echo ""
    echo "❌ Invalid commit message!"
    echo ""
    echo "Commit message must start with one of these prefixes:"
    echo "  • feat:     for a new feature"
    echo "  • chore:    for maintenance tasks"
    echo "  • fix:      for bug fixes"
    echo "  • refacto:  for refactoring"
    echo "  • docs:     for documentation updates"
    echo "  • release:  for release preparations"
    echo ""
    echo "Valid examples:"
    echo "  feat: add commit message validation"
    echo "  fix: correct parsing error in classes"
    echo "  chore: update dependencies"
    echo "  refacto: simplify validation logic"
    echo "  docs: update installation guide"
    echo "  release: bump version to 1.2.0"
    echo ""
    echo "Your message: $(cat $1)"
    echo ""
    exit 1
fi

echo "✅ Valid commit message"
